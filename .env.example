# VulnScanner Environment Configuration
# Copy this file to .env and fill in your actual values
# 
# SECURITY WARNING: The default keys below are for development only!
# Generate new secure keys for production using: python generate_secure_keys.py

# =============================================================================
# APPLICATION IDENTIFICATION
# =============================================================================
APP_NAME=VulnScanner API

# =============================================================================
# SUPABASE DATABASE CONFIGURATION
# =============================================================================
# Primary database connection (Supabase PostgreSQL)
# Find this in Supabase Project Settings → Database → Connection info
# Format: postgresql://postgres:[password]@db.[project-ref].supabase.co:5432/postgres?sslmode=require
SUPABASE_DB_URL=postgresql://postgres:your-password@db.your-project-ref.supabase.co:5432/postgres?sslmode=require

# Local PostgreSQL configuration (preferred for development)
# Async runtime URL (SQLAlchemy 2.0 async engine)
DATABASE_URL_ASYNC=postgresql+asyncpg://krishna:Krishna%402003@localhost:5433/vulscanner
# Sync URL for Alembic migrations (if needed)
DATABASE_URL_SYNC=postgresql+psycopg://krishna:Krishna%402003@localhost:5433/vulscanner

# Docker notes:
# If backend runs inside Docker but DB is on host, use host.docker.internal:
# DATABASE_URL_ASYNC=postgresql+asyncpg://krishna:Krishna%402003@host.docker.internal:5433/vulscanner
# DATABASE_URL_SYNC=postgresql+psycopg://krishna:Krishna%402003@host.docker.internal:5433/vulscanner

# =============================================================================
# APPLICATION SECURITY (CHANGE THESE IN PRODUCTION!)
# =============================================================================
# Main application secret key - MUST be changed in production
SECRET_KEY=jUca4mpVxi1q_lUGpTmhGUXiRaVVquGaO8sjPRHyhy8

# JWT Configuration
JWT_SECRET_KEY=3Ycx1CHdvamXR-abu9xv-1Uh1x579FSjHWfOTr0mEWTtGrG6TPxKS6uGDCC63yrjd-tucS-6J6uUvbHtwI7nhg
JWT_ALGORITHM=HS256
JWT_EXP_MINUTES=60

# CSRF Protection
CSRF_HEADER_NAME=x-csrf-token
CSRF_SECRET=a54188fadcb04fbbb5fb3281eace6de4dc86451abe0ac73c35fcdd4e1decaf86

# Session Security
SESSION_SECRET=02jGJKjyfRGsPZxm1HUPcZJgPgcKnXJqkD5l7nMjqzY

# API Security
API_KEY=08HJluAh3owgMXpGjNi3kJUmmo16sjN6

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================
# CORS Origins (comma-separated list)
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# =============================================================================
# SUPABASE CLIENT CONFIGURATION (Frontend)
# =============================================================================
# Supabase Project URL
SUPABASE_URL=https://your-project-ref.supabase.co

# Supabase Anon Key (safe to expose in frontend)
SUPABASE_ANON_KEY=your-supabase-anon-key

# Supabase Service Role Key (backend only - keep secret!)
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# =============================================================================
# CACHING AND TASK QUEUE
# =============================================================================
# Redis Configuration for caching and Celery task queue
REDIS_URL=redis://localhost:6379/0

# Celery Configuration (local dev, no Docker)
CELERY_BROKER_URL=amqp://guest:guest@localhost:5672//
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_QUEUE=crawler
# Celery app module path (override in Docker to match container layout)
CELERY_APP=tasks.celery_app:celery_app

# Fallback behavior: if the broker is unreachable in development,
# the API will execute crawl tasks locally to avoid blocking UX.
# This is intended for local dev only; use RabbitMQ/Redis with Celery
# workers for proper distributed execution.

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
# Application Environment (development, staging, production)
APP_ENV=development

# Debug Mode (true/false)
DEBUG=true

# Database Echo - SQL query logging (true/false)
DB_ECHO=false

# Log Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# When true, swap 'localhost' with 'host.docker.internal' for DB URL at runtime.
# Use this when the API runs inside Docker and DB is on host.
USE_HOST_DOCKER_INTERNAL=false

# If backend runs in Docker and broker/result are on host:
# USE_HOST_DOCKER_INTERNAL=true
# CELERY_BROKER_URL=amqp://guest:guest@host.docker.internal:5672//
# CELERY_RESULT_BACKEND=redis://host.docker.internal:6379/1
# For Docker Compose default services:
# CELERY_BROKER_URL=amqp://vulscan:vulscan@rabbitmq:5672//
# CELERY_RESULT_BACKEND=redis://redis:6379/1

# Local Development Mode (bypass Supabase and use SQLite dev.db)
# When true, the backend uses a local SQLite database at ./dev.db
# and enables relaxed auth behavior suitable for local development.
DEVELOPMENT_MODE=true

# Skip Supabase integration entirely (use local SQLite)
# Set to true for local development without Supabase.
# Leave SUPABASE_DB_URL empty when this is true.
SKIP_SUPABASE=true

# =============================================================================
# CRAWLER CONFIGURATION
# =============================================================================
# Default crawler settings
CRAWLER_MAX_DEPTH=3
CRAWLER_MAX_PAGES=1000
CRAWLER_REQUESTS_PER_SECOND=10
CRAWLER_TIMEOUT=30
CRAWLER_USER_AGENT=VulnScanner/1.0

# =============================================================================
# SECURITY HEADERS
# =============================================================================
# Security header configuration
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# =============================================================================
# INSTRUCTIONS
# =============================================================================
# 1. Copy this file to .env: cp .env.example .env
# 2. Choose your database:
#    - Supabase: fill SUPABASE_DB_URL and leave DATABASE_URL_ASYNC/DATABASE_URL_SYNC empty
#    - Local Postgres: comment SUPABASE_DB_URL and set DATABASE_URL_ASYNC and DATABASE_URL_SYNC
#       • Create DB: createdb vulscanner (or via docker-compose Postgres service)
#       • Run migrations: alembic upgrade head (ensure DATABASE_URL_SYNC is set)
#       • Start API: uvicorn backend.main:app --reload
# 3. IMPORTANT: Generate new secure keys for production using: python generate_secure_keys.py
# 4. Update CORS_ORIGINS for your production domains
# 5. Set up Redis if using caching/task queue features
# 6. Configure crawler settings based on your requirements
# 7. Enable security headers in production
# 
# SECURITY CHECKLIST:
# □ Changed all default secret keys
# □ Updated Supabase connection details
# □ Configured CORS origins
# □ Set appropriate log levels
# □ Enabled security headers for production